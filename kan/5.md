```javascript
threshold=0.7
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 420/420 [00:32<00:00, 12.88it/s]
FPS: 12.883415645392025
elapsed_time_ms: 77.61916773659843
Avg Forward Time per Image: 70.8291286513919 ms
Wrote profile results to CPUtttt.py.lprof
Timer unit: 1e-06 s

Total time: 37.8213 s
File: /home/nvidia/heShaoWei/GFNet/dynn/gfnet_dynn.py
Function: forward at line 296

Line #      Hits         Time  Per Hit   % Time  Line Contents
==============================================================
   296                                               @profile
   297                                               def forward(self, x):
   298       520       3094.8      6.0      0.0          B = x.shape[0]
   299       520     873795.3   1680.4      2.3          x = self.patch_embed(x)
   300       520      20208.0     38.9      0.1          cls_tokens = self.cls_token.expand(B, -1, -1)
   301       520      12225.2     23.5      0.0          dist_token = self.dist_token.expand(B, -1, -1)
   302       520     155788.7    299.6      0.4          x = torch.cat((cls_tokens, dist_token, x), dim=1)
   303       520      79626.6    153.1      0.2          x = x + self.pos_embed
   304       520      36101.5     69.4      0.1          x = self.pos_drop(x)
   305                                                   # threshold_tensor = torch.tensor(self.threshold, device=x.device)
   306      4877      23301.0      4.8      0.1          for blk_idx, blk in enumerate(self.blocks):
   307      4852   34902126.7   7193.3     92.3              x = blk.forward(x)
   308                                                       # if blk_idx in [7, 9, 10]:
   309      4852      11930.1      2.5      0.0              if blk_idx in [7, 8, 9]:
   310      1162     265559.2    228.5      0.7                  inter_z = self.norm(x)
   311      1162     444191.6    382.3      1.2                  inter_logit = (self.intermediate_heads[blk_idx](inter_z[:, 0]) + self.intermediate_heads_dist[blk_idx](inter_z[:, 1])) / 2
   312      1162     882039.6    759.1      2.3                  g = self.gates[blk_idx](inter_logit)
   313      1162      26111.8     22.5      0.1                  g = torch.sigmoid(g)
   314      1162      69721.8     60.0      0.2                  if g >= self.threshold:  # 用torch.jit.script时可以使用.item()
   315       495       1246.4      2.5      0.0                      return inter_logit, blk_idx
   316
   317        25       5474.7    219.0      0.0          x = self.norm(x)
   318        25       8118.5    324.7      0.0          x = (self.head(x[:, 0]) + self.head_dist(x[:, 1])) / 2
   319        25        604.9     24.2      0.0          return x, len(self.blocks) - 1
```
